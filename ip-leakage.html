<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>IP Leakage Write-up - s8n</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>

  <style>
    /* --- GLOBAL STYLES --- */
    body {
      margin: 0;
      padding: 0;
      background: black;
      font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      color: #e0e0e0;
      line-height: 1.7;
    }

    canvas {
      position: fixed !important;
      top: 0;
      left: 0;
      z-index: -1;
    }

    /* Links - Light Blue */
    a { color: #4db8ff; text-decoration: none; transition: 0.2s; }
    a:hover { color: white; text-decoration: underline; }

    /* --- CONTENT CONTAINER --- */
    .content {
      position: relative;
      z-index: 10;
      max-width: 800px;
      margin: 40px auto 100px;
      padding: 50px;
      background: rgba(15, 15, 15, 0.85);
      backdrop-filter: blur(8px);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    }

    /* --- TYPOGRAPHY --- */
    h1 {
      margin-top: 10px;
      font-size: 2rem;
      color: #4db8ff; /* Blueish Title */
      line-height: 1.3;
    }

    h2 {
      margin-top: 45px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      padding-bottom: 10px;
      color: #fff;
      font-weight: 400;
      letter-spacing: 0.5px;
    }

    h3 {
      margin-top: 35px;
      color: #ffffff; 
      font-weight: 700;
      font-size: 1.2rem;
    }

    p, li {
      font-size: 1.05rem;
      color: #ccc;
      margin-bottom: 20px;
    }

    code {
      background: rgba(255,255,255,0.1);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: "Courier New", monospace;
      color: #ff9999;
      font-size: 0.9em;
    }

    /* --- BOUNTY BADGES --- */
    .meta-header {
      display: flex;
      gap: 15px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .badge {
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .severity-medium {
      background: rgba(255, 165, 0, 0.2);
      border: 1px solid orange;
      color: orange;
    }

    /* Bounty Green */
    .bounty {
      background: rgba(0, 255, 136, 0.15);
      border: 1px solid #00ff88;
      color: #00ff88;
    }

    /* --- IMAGES --- */
    .img-container {
      margin: 40px 0;
      text-align: center;
    }

    img {
      max-width: 100%;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.15);
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    }

    .img-caption {
      display: block;
      margin-top: 10px;
      font-size: 0.85rem;
      color: #777;
      font-style: italic;
    }

    /* --- BACK BUTTON --- */
    .back-btn {
      display: inline-block;
      margin-bottom: 20px;
      color: #888;
      font-size: 0.9rem;
    }
    .back-btn:hover { color: white; text-decoration: none; }

    /* --- FOLLOW BUTTON --- */
    .x-follow {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 30;
      font-size: 13px;
      color: #ccc;
      text-decoration: none;
      padding: 6px 14px;
      border-radius: 8px;
      background: rgba(0,0,0,0.35);
      backdrop-filter: blur(4px);
      border: 1px solid rgba(255,255,255,0.15);
      transition: 0.2s ease;
    }
    .x-follow:hover {
      color: white;
      background: rgba(255,255,255,0.1);
      border-color: rgba(255,255,255,0.35);
    }
  </style>
</head>

<body>

<a class="x-follow" href="https://x.com/robotics8n" target="_blank">follow me on X</a>

<div class="content">
  <a href="index.html" class="back-btn">‚Üê Back to Home</a>
  
  <h1>User IP Address Leakage via Unproxied External Resources</h1>
  
  <div class="meta-header">
    <div class="badge severity-medium">Severity: Medium</div>
    <div class="badge bounty">Bounty: $1,675</div>
    <div class="badge" style="border: 1px solid #555; color: #aaa;">Date: Nov 2025</div>
  </div>

  <h2>Introduction</h2>
  <p>
    Recently I was hunting on a target when I discovered a privacy issue that could allow malicious actors to deanonymize users.
  </p>
  <p>
    Privacy leaks are often overlooked in bug bounties, but when a vulnerability allows an attacker to correlate a user's identity with their real-world physical location (via IP address), the impact becomes significant. Here is how I found it.
  </p>

  <h2>The Discovery</h2>
  <p>
    While testing the profile settings, I noticed the "Profile Picture" feature allowed users to upload images via URL. I immediately wondered: <em>Does the server download this image and host it? Or does it force every visitor's browser to fetch it directly?</em>
  </p>
  <p>
    I realized that the application was loading external resources directly from third-party servers without proxying the request through their backend. This meant that if I could control the image URL, I could see the IP address of anyone who viewed my profile.
  </p>

  <h2>The Exploitation</h2>
  
  <h3>Step 1: The Setup</h3>
  <p>
    To verify this, I needed a server that I controlled to capture the incoming requests. I used an OAST (Out-of-Band Application Security Testing) service to generate a payload.
  </p>
  <p>
    I set my profile picture URL to my controlled domain:
    <br><code>https://[attacker-domain].oast.fun/.png</code>
  </p>

  <!-- IMAGE 1 -->
  <div class="img-container">
    <img src="image.png" alt="Payload Injection">
    <span class="img-caption">Figure 1: Injecting the external payload into the profile picture input.</span>
  </div>

  <h3>Step 2: Triggering the Leak</h3>
  <p>
    Once the profile picture was saved, the trap was set. When any user, or even an admin, views the profile, their browser tries to render the image. To do so, it sends a GET request to my server.
  </p>

  <!-- IMAGE 2 -->
  <div class="img-container">
    <img src="image(1).png" alt="Browser Request">
    <span class="img-caption">Figure 2: The browser automatically making the request to the external source.</span>
  </div>

  <h3>Step 3: Confirmation</h3>
  <p>
    Checking my server logs, I received immediate confirmation. The logs revealed the <strong>Real IP address</strong>, the <strong>User-Agent</strong> (browser and OS info), and the <strong>Referer header</strong> of the victim.
  </p>

  <!-- IMAGE 3: SERVER LOGS -->
  <div class="img-container">
    <img src="screenshot.png" alt="Server Logs">
    <span class="img-caption">Figure 3: My server logs capturing the victim's IP address and User-Agent.</span>
  </div>

  <h2>Why This Matters</h2>
  <p>
    This vulnerability allows an attacker to de-anonymize users. On a platform like this, where users might want to remain pseudonymous, linking an account to a physical home IP address is a privacy violation. The impact is amplified if a malicious actor places themselves on the <strong>Leaderboard</strong>, potentially harvesting data from hundreds of users passively.
  </p>

  <h2>The Fix</h2>
  <p>
    I recommended to the team that they implement an image proxy to serve external profile pictures through their own infrastructure. This prevents direct requests from user browsers to external domains. This approach is standard practice on platforms like Discord, Reddit, and Slack.
  </p>

  <h2>Timeline & Payout</h2>
  <p>
    The team was quick to respond and validated the finding. They assessed it as <strong>Medium Severity</strong> and rewarded a bounty of <strong>$1,675</strong>.
  </p>

  <!-- IMAGE 4: PAYOUT -->
  <div class="img-container">
    <img src="payout.jpg" alt="Bounty Payout">
    <span class="img-caption">Figure 4: Bounty confirmation.</span>
  </div>
  
  <br>
  <p style="font-size: 0.9rem; color: #666; border-top: 1px solid #333; padding-top: 20px;">
    Written by s8n.
  </p>

</div>

<script>
  /* --- ANIMATION LOOP --- */
  let f = 0;

  function setup() {
    createCanvas(windowWidth, windowHeight, WEBGL);
  }

  function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
  }

  function draw() {
    background(0);

    let w = PI / 6;
    let P = w * 3;

    pointLight(255, 255, 255, 0, 0, 300);

    rotateX(PI / 6);
    rotateY(f -= 0.01);

    for (let x = 0; x < TAU; x += w) {
      for (let y = 0; y < TAU; y += P) {
        push();
        rotateY(x);
        rotateX(f * 0.3);

        push();
        translate(0, 0, 180);
        specularMaterial(200); 
        torus(90, 12, 16, 8);
        pop();

        pop();
      }
    }
  }
</script>

</body>
</html>
